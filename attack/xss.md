## 跨站脚本攻击XSS

> Cross Site Scripting，缩写XSS（为了不和层叠样式表Cascading Style Sheets，CSS的缩写混淆，所以缩写为XSS） 跨站脚本是一种网站应用程序的安全漏洞攻击，是代码注入的一种。它允许恶意用户将代码注入到网页上，其他用户在观看网页时就会受到影响。这类攻击通常包含了HTML以及用户端脚本语言。

XSS的实质其实是HTML代码与JavaScript代码的注入。  
跨站脚本攻击是指恶意攻击者往Web页面里插入恶意JavaScript代码，当用户浏览该页面时，嵌入在其中的代码会被执行，从而达到恶意攻击用户的目的。

- 反射型XSS  
  非持久化。需要欺骗用户自己去点击链接才能触发XSS代码，（服务器中没有这样的页面和内容），一般容易出现在搜索页面。  
  
  ```
  用户输入带有参数的URL --> 
  JavaScript处理URL并获取参数 --> 
  通过DOM调用参数对页面进行排版 --> 
  通过DOM动态输出到页面上
  ```


- 存储型XSS  
  持久化。代码是存储在服务器中的，如在个人信息或发表文章等地方，加入代码，如果没有过滤或过滤不严，那么这些代码将存储在服务器中，用户访问该页面的时候触发代码执行。这种XSS比较危险，容易造成蠕虫，盗窃cookies。

  ```
  用户输入带有参数的URL或BODY域数据 -->   
  服务器将参数存入数据库 -->   
  通过JSON格式返回参数到页面 --> 
  通过DOM调用参数进行排版 -->  
  通过DOM动态输出到页面上
  ```

XSS修复
- 不含有富文本编辑器（自定义样式）且没有使用DOM的站点：  
   输入：过滤双引号，单引号，左右尖括号，分号  
   输出：对上述字符进行HTML实体编码即可。

- 不含有富文本编辑器但使用DOM的站点  
  输入：在DOM中转义双引号，单引号，左右尖括号，分号  
  输出：在输出之前进行编码，如： innerHTML=encodeHTML(output)。


- 含有富文本编辑器但没有使用DOM的站点  
  输入：过滤双引号，单引号，分号  
  输出：对上述字符进行HTML实体编码即可。

- 不含有富文本编辑器但使用DOM的站点  
  指哪儿修哪儿

  